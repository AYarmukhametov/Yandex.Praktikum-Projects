# Предсказание коэффициента восстановления золота из золотосодержащей руды

**Цель**: необходимо создать прототип модели машинного обучения для золотодобывающей компании. Модель должна предсказывать коэффициент восстановления золота из золотосодержащей руды. В распоряжении данные с параметрами добычи и очистки.
Модель должна помочь оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.

**Результат**: построена модель линейной ргерессии для предсказания количества золота в руде, однако модель ведет себя хуже, чем предсказание золота, основанное на медиане по историческим данным.

**Стек**: Pandas, NumPy, Sklearn, Matplotlib.

**Статус**: планируется доработка - использование моделей градиентного бустинга.

## Технологический процесс

Когда добытая руда проходит первичную обработку, получается дроблёная смесь. Её отправляют на флотацию (обогащение) и двухэтапную очистку.

## 1. Флотация

Во флотационную установку подаётся смесь золотосодержащей руды. После обогащения получается черновой концентрат и «отвальные хвосты», то есть остатки продукта с низкой концентрацией ценных металлов.

На стабильность этого процесса влияет непостоянное и неоптимальное физико-химическое состояние флотационной пульпы (смеси твёрдых частиц и жидкости).

## 2. Очистка

Черновой концентрат проходит две очистки. На выходе получается финальный концентрат и новые отвальные хвосты.

## Расчёт эффективности

Нужно смоделировать процесс восстановления золота из золотосодержащей руды. Эффективность обогащения рассчитывается по формуле:

![Формула восстановления золота](https://github.com/AYarmukhametov/Yandex.Praktikum-Projects/blob/main/gold%20recovery/formula.jpg?raw=true)

где:

-  C — доля золота в концентрате после флотации/очистки;
-  F — доля золота в сырье/концентрате до флотации/очистки;
-  T — доля золота в отвальных хвостах после флотации/очистки.

Для прогноза коэффициента нужно найти долю золота в концентратах и хвостах. Причём важен не только финальный продукт, но и черновой концентрат.

## Метрика качества

Для решения задачи используется метрика качества sMAPE (англ. Symmetric Mean Absolute Percentage Error, «симметричное среднее абсолютное процентное отклонение»).

Метрика sMAPE вычисляется так:

![sMape](https://github.com/AYarmukhametov/Yandex.Praktikum-Projects/blob/main/gold%20recovery/smape.jpg?raw=true)

Нужно спрогнозировать сразу две величины:

-  эффективность обогащения чернового концентрата rougher.output.recovery;
-  эффективность обогащения финального концентрата final.output.recovery.

Итоговая метрика складывается из двух величин:

![Финальная sMAPE](https://github.com/AYarmukhametov/Yandex.Praktikum-Projects/blob/main/gold%20recovery/final_smape.jpg?raw=true)
