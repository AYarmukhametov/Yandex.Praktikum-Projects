# Предсказание коэффициента восстановления золота из золотосодержащей руды

Необходимо создать прототип модели машинного обучения для золотодобывающей компании. Модель должна предсказывать коэффициент восстановления золота из золотосодержащей руды. В распоряжении данные с параметрами добычи и очистки.
Модель должна помочь оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.

## Технологический процесс

Когда добытая руда проходит первичную обработку, получается дроблёная смесь. Её отправляют на флотацию (обогащение) и двухэтапную очистку.

![Техпроцесс](https://github.com/AYarmukhametov/Gold-recovery/blob/main/tech%20process.jpg?raw=true)

## 1. Флотация

Во флотационную установку подаётся смесь золотосодержащей руды. После обогащения получается черновой концентрат и «отвальные хвосты», то есть остатки продукта с низкой концентрацией ценных металлов.

На стабильность этого процесса влияет непостоянное и неоптимальное физико-химическое состояние флотационной пульпы (смеси твёрдых частиц и жидкости).

## 2. Очистка

Черновой концентрат проходит две очистки. На выходе получается финальный концентрат и новые отвальные хвосты.

# Описание данных
## Технологический процесс:

- Rougher feed — исходное сырье
- Rougher additions (или reagent additions) — флотационные реагенты: Xanthate, Sulphate, Depressant
- Xanthate — ксантогенат (промотер, или активатор флотации)
- Sulphate — сульфат (на данном производстве сульфид натрия)
- Depressant — депрессант (силикат натрия)
- Rougher process (англ. «грубый процесс») — флотация
- Rougher tails — отвальные хвосты
- Float banks — флотационная установка
- Cleaner process — очистка
- Rougher Au — черновой концентрат золота
- Final Au — финальный концентрат золота

## Параметры этапов:
- air amount — объём воздуха
- fluid levels — уровень жидкости
- feed size — размер гранул сырья
- feed rate — скорость подачи

## Наименование признаков
Наименование признаков такое: [этап].[тип_параметра].[название_параметра]

Пример: rougher.input.feed_ag

Возможные значения для блока [этап]:
-  rougher — флотация
-  primary_cleaner — первичная очистка
-  secondary_cleaner — вторичная очистка
-  final — финальные характеристики
Возможные значения для блока [тип_параметра]:
-  input — параметры сырья
-  output — параметры продукта
-  state — параметры, характеризующие текущее состояние этапа
-  calculation — расчётные характеристики

## Расчёт эффективности

Нужно смоделировать процесс восстановления золота из золотосодержащей руды. Эффективность обогащения рассчитывается по формуле:

![Формула восстановления золота](https://github.com/AYarmukhametov/Gold-recovery/blob/main/formula.jpg?raw=true)

где:

-  C — доля золота в концентрате после флотации/очистки;
-  F — доля золота в сырье/концентрате до флотации/очистки;
-  T — доля золота в отвальных хвостах после флотации/очистки.

Для прогноза коэффициента нужно найти долю золота в концентратах и хвостах. Причём важен не только финальный продукт, но и черновой концентрат.

## Метрика качества

Для решения задачи используется метрика качества sMAPE (англ. Symmetric Mean Absolute Percentage Error, «симметричное среднее абсолютное процентное отклонение»).

Метрика sMAPE вычисляется так:

![sMape](https://github.com/AYarmukhametov/Gold-recovery/blob/main/smape.jpg?raw=true)

Нужно спрогнозировать сразу две величины:

-  эффективность обогащения чернового концентрата rougher.output.recovery;
-  эффективность обогащения финального концентрата final.output.recovery.

Итоговая метрика складывается из двух величин:

![Финальная sMAPE](https://github.com/AYarmukhametov/Gold-recovery/blob/main/final_smape.jpg?raw=true)
